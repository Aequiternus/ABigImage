(function(R){var af=R("<div>").css({display:"none"}).appendTo("body"),O=R("<div>").css({display:"none"}).appendTo("body"),n=R("<div>").appendTo(O),T=R("<div>").appendTo(n),E=R("<div>").appendTo(T),v=R("<div>").appendTo(E),A=R("<div>").appendTo(n),K=R("<div>").appendTo(A),U=R("<div>").appendTo(K),p=R("<img>").appendTo(n),z=R("<img>").appendTo(n),X=R("<img>").appendTo(n),b=R("<div>").appendTo(O);var L={},Y=null,ae=null,ah=0,C=false;function ac(){var d=ae+1;if(d>=Y.length){d=0}return d}function o(){var d=ae-1;if(d<0){d=Y.length-1}return d}function f(){if(ah===Y.length-1){return aa()}else{++ah;return I(ac())}}function N(){if(ah===1-Y.length){return aa()}else{--ah;return I(o())}}function F(d){if(L.keyNext.indexOf(d.which)!==-1){d.preventDefault();f()}else{if(L.keyPrev.indexOf(d.which)!==-1){d.preventDefault();N()}else{if(L.keyClose.indexOf(d.which)!==-1){d.preventDefault();aa()}}}}function I(k,d){if("number"===typeof k){if(k===ae||k<0||k>Y.length-1){return}ae=k;var t=R(Y[ae]);k=t.data("href")||t.attr("href")}else{if("number"!==typeof d){d=-1}if(ae===d){return}ae=d}C=true;p.removeAttr("src").attr("src",k);var s=R(Y[ac()]);z.removeAttr("src").attr("src",s.data("href")||s.attr("href"));var i=R(Y[o()]);X.removeAttr("src").attr("src",i.data("href")||i.attr("href"));af.fadeIn(L.fadeIn);O.fadeIn(L.fadeIn);L.onopen.call(Y,Y[ae],ae);R(document).unbind("keydown",F).bind("keydown",F);return false}function aa(){if(!C){return}C=false;ae=null;ah=0;af.fadeOut(L.fadeOut);O.fadeOut(L.fadeOut);L.onclose.call(Y);R(document).unbind("keydown",F);return false}T.click(function(){return N()});A.click(function(){return aa()});var h=function(d){d.preventDefault()};O.on("touchmove",h).on("wheel",h);var r,q,w,W,V,Z,ad,l,g,H,S,J,a,e,ai,B,ak,M,Q,ab;aj();function aj(){W=0;V=0;Z=1;B=null;if(L.imgCSS){p.css({zIndex:L.imgCSS.zIndex})}}function D(k,x){var s=0;for(var i=0,d=k.length;i<d;i++){s+=k[i]["page"+x]}return s/d}function ag(d){return Math.sqrt(Math.pow(d.touches[0].pageX-d.touches[1].pageX,2)+Math.pow(d.touches[0].pageY-d.touches[1].pageY,2))}p[0].addEventListener("touchstart",function(d){if(d.touches.length>1){ad=ag(d);p.css({zIndex:L.prevBtnBoxCSS.zIndex})}else{B=null;J=(new Date()).getTime();a=n.width()*0.34;e=n.height();ai=L.slideWidth*a;H=p.width();S=p.height()}r=W;q=V;w=Z;l=0;g=0;ak=d.touches;d.preventDefault()});p[0].addEventListener("touchmove",function(i){l=(D(i.touches,"X")-D(ak,"X"));g=(D(i.touches,"Y")-D(ak,"Y"));W=r+l/Z;V=q+g/Z;if(i.touches.length>1){Z=Math.max(1,w*(ag(i)/ad))}if(Z>L.zoomMin){var k=0.5*(H-(H/Z));var d=0.5*(S-(S/Z));W=Math.max(-k,Math.min(k,W));V=Math.max(-d,Math.min(d,V))}else{if(null===B){B=Math.abs(g)>Math.abs(l)}if(B){W=0}else{V=0}}u(W,V,Z);i.preventDefault()});p[0].addEventListener("touchend",function(i){var d=(new Date()).getTime()-J;if(!i.touches.length){if(Z<=L.zoomMin){if(d<20&&l<=1&&g<=1){u(0,0,1,false);f()}else{if(B){var k=Math.abs(g);if(k>ai){G(c)}else{if(k/d>L.slideVelocity){G(c)}else{G(j)}}}else{if(l<-ai){P()}else{if(l>ai){m()}else{if(Math.abs(l)/d>L.slideVelocity){if(l<0){P()}else{m()}}else{G(j)}}}}}aj()}else{if(Z>L.zoomMax){Z=L.zoomMax;u(W,V,Z,true)}}}if(Z<=L.zoomMin){p.css({zIndex:L.imgCSS.zIndex})}ak=i.touches;i.preventDefault()});n.on("transitionend webkitTransitionEnd msTransitionEnd oTransitionEnd",function(){ab=false;if(Q){Q();Q=null;u(0,0,1,false)}else{if(M){M();M=null}}});p.click(function(){return f()});function P(){setTimeout(function(){Q=f},100);u(-a,0,1,true)}function m(){setTimeout(function(){Q=N},100);u(a,0,1,true)}function j(){u(0,0,1,true)}function c(){j();aa()}function G(d){if(ab){M=d}else{d()}}function u(d,al,k,t){ab=true;if(true===t){t="all .2s ease-out"}else{if(false===t){t=""}else{t="all .02s linear"}}var i="scale("+k+") translate("+d+"px, "+al+"px)";n.css({"-webkit-transform":i,"-moz-transform":i,"-ms-transform":i,"-o-transform":i,transform:i,transition:t})}R.fn.abigimage=function(s){Y=this;L=R.extend(true,R.fn.abigimage.defaults,s);this.overlay=af.attr(L.overlayAttrs).css(L.overlayCSS);this.layout=O.attr(L.layoutAttrs).css(L.layoutCSS);this.box=n.attr(L.boxAttrs).css(L.boxCSS);this.prevBtnWrapper=T.attr(L.prevBtnWrapperAttrs).css(L.prevBtnWrapperCSS);this.prevBtnBox=E.attr(L.prevBtnBoxAttrs).css(L.prevBtnBoxCSS);this.prevBtn=v.attr(L.prevBtnAttrs).css(L.prevBtnCSS).html(L.prevBtnHtml);this.closeBtnWrapper=A.attr(L.closeBtnWrapperAttrs).css(L.closeBtnWrapperCSS);this.closeBtnBox=K.attr(L.closeBtnBoxAttrs).css(L.closeBtnBoxCSS);this.closeBtn=U.attr(L.closeBtnAttrs).css(L.closeBtnCSS).html(L.closeBtnHtml);this.img=p.attr(L.imgAttrs).css(L.imgCSS);this.imgNext=z.attr(L.imgNextAttrs).css(L.imgNextCSS);this.imgPrev=X.attr(L.imgPrevAttrs).css(L.imgPrevCSS);this.bottom=b.attr(L.bottomAttrs).css(L.bottomCSS);var k={};for(var t in L.prevBtnHoverCSS){if(L.prevBtnCSS){k[t]=L.prevBtnCSS[t]}}var d={};for(var t in L.closeBtnHoverCSS){if(L.closeBtnCSS){d[t]=L.closeBtnCSS[t]}}var i={};for(var t in L.bottomHoverCSS){if(L.bottomCSS){i[t]=L.bottomCSS[t]}}this.prevBtnWrapper.hover(function(){v.stop().animate(L.prevBtnHoverCSS,L.fadeIn)},function(){v.stop().animate(k,L.fadeOut)});this.closeBtnWrapper.hover(function(){U.stop().animate(L.closeBtnHoverCSS,L.fadeIn)},function(){U.stop().animate(d,L.fadeOut)});this.bottom.hover(function(){b.stop().animate(L.bottomHoverCSS,L.fadeIn)},function(){b.stop().animate(i,L.fadeOut)});return this.each(function(x){R(this).unbind("click.abigimage").bind("click.abigimage",function(){return I(x)})})};R.abigimage={open:I,next:f,prev:N,close:aa};R.fn.abigimage.defaults={fadeIn:"fast",fadeOut:"fast",slideWidth:0.4,slideVelocity:0.4,zoomMin:1.5,zoomMax:5,prevBtnHtml:"&larr;",closeBtnHtml:"x",keyNext:[13,32,39,40],keyPrev:[8,37,38],keyClose:[27,35,36],onopen:function(){},onclose:function(){},overlayCSS:{position:"fixed",zIndex:101,top:0,right:0,bottom:0,left:0,backgroundColor:"#000",opacity:0.9},layoutCSS:{position:"fixed",zIndex:101,top:0,right:0,bottom:0,left:0,"-webkit-user-select":"none","-moz-user-select":"none","user-select":"none","-webkit-tap-highlight-color":"rgba(0, 0, 0, 0)",lineHeight:2.5},boxCSS:{position:"absolute",width:"312.5%",height:"100%",left:"-106.25%",top:0},prevBtnWrapperCSS:{cursor:"pointer",position:"absolute",top:0,right:"50%",bottom:0,left:0},closeBtnWrapperCSS:{cursor:"pointer",position:"absolute",top:0,right:0,bottom:0,left:"50%"},prevBtnBoxCSS:{position:"absolute",zIndex:103,top:0,bottom:0,left:"68%"},closeBtnBoxCSS:{position:"absolute",zIndex:103,top:0,bottom:0,right:"68%"},prevBtnCSS:{color:"#fff",backgroundColor:"#000",opacity:0.5,padding:"0 1em",borderRadius:"0 0 1ex 0"},closeBtnCSS:{color:"#fff",backgroundColor:"#000",opacity:0.5,padding:"0 1em",borderRadius:"0 0 0 1ex"},prevBtnHoverCSS:{opacity:1},closeBtnHoverCSS:{opacity:1},imgCSS:{position:"absolute",zIndex:102,margin:"auto",width:"auto",top:0,right:0,bottom:0,left:0,display:"block",cursor:"pointer",maxWidth:"32%",maxHeight:"100%"},imgNextCSS:{position:"absolute",margin:"auto",width:"auto",top:0,right:0,bottom:0,left:"68%",display:"block",maxWidth:"32%",maxHeight:"100%"},imgPrevCSS:{position:"absolute",margin:"auto",width:"auto",top:0,right:"68%",bottom:0,left:0,display:"block",maxWidth:"32%",maxHeight:"100%"},bottomCSS:{position:"fixed",zIndex:104,right:0,bottom:0,left:0,"-webkit-user-select":"text","-moz-user-select":"text","user-select":"text",backgroundColor:"#000",color:"#fff",opacity:0.5,padding:"0 1em",textAlign:"center"},bottomHoverCSS:{opacity:1},overlayAttrs:{},layoutAttrs:{},boxAttrs:{},prevBtnWrapperAttrs:{},prevBtnBoxAttrs:{},prevBtnAttrs:{},closeBtnWrapperAttrs:{},closeBtnBoxAttrs:{},closeBtnAttrs:{},imgAttrs:{},imgNextAttrs:{},imgPrevAttrs:{},bottomAttrs:{}}}(jQuery));